(this["webpackJsonpsaba-react-framework"]=this["webpackJsonpsaba-react-framework"]||[]).push([[197,82],{1547:function(t,e,n){"use strict";n.r(e);var a=n(4),r=n(13),o=n(3),i=n.n(o),c=n(0),l=(n(1326),n(21)),u=n(342),s=n(141),d=n(31),p=n(350),f=n(244),b=n(129),v=n(237),m=n(2),h=Object(c.lazy)((function(){return Promise.all([n.e(5),n.e(70)]).then(n.bind(null,473))})),j=Object(c.lazy)((function(){return Promise.all([n.e(5),n.e(71)]).then(n.bind(null,474))})),g=Object(c.lazy)((function(){return Promise.all([n.e(1),n.e(5),n.e(46)]).then(n.bind(null,459))})),O=Object(c.lazy)((function(){return Promise.all([n.e(5),n.e(72)]).then(n.bind(null,475))})),y=Object(c.lazy)((function(){return n.e(195).then(n.bind(null,1254))})),x=function(t){t.loading;var e,n=Object(s.a)().layout,a=Object(p.b)(n),o=function(){var t=Object(d.j)();return t?Object(d.h)(t.role_name):"/login"},i=Object(l.i)([{path:"/",index:!0,element:Object(m.jsx)(l.a,{replace:!0,to:o()})},{path:"/login",element:Object(m.jsx)(u.a,{}),children:[{path:"/login",element:Object(m.jsxs)(f.b,{clientId:"1096092734184-n0tcl5abejf0s0r2t4fmoi3qf4fhen76.apps.googleusercontent.com",children:[Object(m.jsx)(g,{})," "]})}]},{path:"/error",element:Object(m.jsx)(u.a,{}),children:[{path:"/error",element:Object(m.jsx)(h,{})}]},{path:"/public/:pageId",element:Object(m.jsx)(y,{}),meta:{publicRoute:!0,layout:"blank"}},{path:"/public/:moduleId/:pageId",element:Object(m.jsx)(y,{}),meta:{publicRoute:!0,layout:"blank"}},{path:"*",element:Object(m.jsx)(u.a,{}),children:[{path:"*",element:Object(m.jsx)(b.a,{})}]}].concat(Object(r.a)(a))),c=Object(l.i)([{path:"/",index:!0,element:Object(m.jsx)(l.a,{replace:!0,to:o()})},{path:"/login",element:Object(m.jsx)(u.a,{}),children:[{path:"/login",element:Object(m.jsxs)(f.b,{clientId:"1096092734184-n0tcl5abejf0s0r2t4fmoi3qf4fhen76.apps.googleusercontent.com",children:[Object(m.jsx)(g,{})," "]})}]},{path:"/auth/not-auth",element:Object(m.jsx)(u.a,{}),children:[{path:"/auth/not-auth",element:Object(m.jsx)(O,{})}]},{path:"/error",element:Object(m.jsx)(u.a,{}),children:[{path:"/error",element:Object(m.jsx)(j,{})}]},{path:"/public/:pageId",element:Object(m.jsx)(y,{}),meta:{publicRoute:!0,layout:"blank"}},{path:"/public/:moduleId/:pageId",element:Object(m.jsx)(y,{}),meta:{publicRoute:!0,layout:"blank"}},{path:"*",element:Object(m.jsx)(u.a,{}),children:[{path:"*",element:Object(m.jsx)(b.a,{})}]}].concat(Object(r.a)(a)));return(null===(e=v.a.getState())||void 0===e?void 0:e.my_menu.dataMyMenu.length)>0?i:c},w=n(14),U=n(198),S=n(62),k=n(35),I=n(403),_=n(117),D=n(1327),C=n(60),A=n.n(C),T=Object.keys(D).filter((function(t){return"fas"!==t&&"prefix"!==t})).map((function(t){return D[t]}));_.b.add.apply(_.b,Object(r.a)(T));e.default=function(){var t=Object(w.b)(),e=Object(c.useRef)(!1),n=Object(l.f)();function r(){return o.apply(this,arguments)}function o(){return o=Object(a.a)(i.a.mark((function t(){var e,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(null!==(e=sessionStorage.getItem("serversList"))&&void 0!==e?e:"[]"),t.next=3,Promise.all(null===n||void 0===n?void 0:n.map(function(){var t=Object(a.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e,{method:"HEAD"});case 3:return n=t.sent,t.abrupt("return",n.ok);case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return t.stop()}}),t)}))),o.apply(this,arguments)}return Object(c.useEffect)((function(){if(null!==Object(d.n)()&&"/error"!==window.location.pathname){var t=null,e=function(){var e=new Date;if(document.hidden)localStorage.setItem("inactive",Date.parse(e)/1e3),clearInterval(t);else{var n=localStorage.getItem("inactive"),a=parseInt(n,10),o=new Date(1e3*a),i=Math.abs(e.getTime()-o.getTime())/1e3;i>=15?(console.log("Fetching data after ".concat(i," seconds of inactivity")),v.a.dispatch(Object(S.e)({unread_count:1})).then((function(t){if(null!==t&&void 0!==t&&t.payload){var e,n,a=null!==(e=null===t||void 0===t||null===(n=t.payload[0])||void 0===n?void 0:n.count_unread)&&void 0!==e?e:0;if(a){var o=a>0&&a<=20?"(".concat(a,")"):"(20+)";document.title="".concat(o," ").concat(document.title.replaceAll(o,"")),r()}}}))):t=setInterval((function(){var n=Math.abs(e.getTime()-o.getTime())/1e3;n>=15&&(console.log("Fetching data after ".concat(n," seconds of inactivity")),v.a.dispatch(Object(S.e)({unread_count:1})).then((function(t){if(null!==t&&void 0!==t&&t.payload){var e,n,a=null!==(e=null===t||void 0===t||null===(n=t.payload[0])||void 0===n?void 0:n.count_unread)&&void 0!==e?e:0;if(a){var o=a>0&&a<=20?"(".concat(a,")"):"(20+)";document.title="".concat(o," ").concat(document.title.replaceAll(o,""))}r()}})),clearInterval(t))}),1e3)}};return document.addEventListener("visibilitychange",e),function(){clearInterval(t),document.removeEventListener("visibilitychange",e)}}}),[]),Object(c.useEffect)((function(){return e.current||(navigator.onLine?t(Object(U.b)({})).then((function(t){var e;if("rejected"===(null===t||void 0===t||null===(e=t.meta)||void 0===e?void 0:e.requestStatus))console.error("Not Registered"),A.a.fire({icon:"error",title:"Connection Failed!",text:"There is a problem connecting to the server or this app is not yet registered with Saba Official.",confirmButtonText:"Refresh",customClass:{confirmButton:"btn btn-primary"}}).then((function(t){t.isConfirmed&&location.reload()}));else{var a,r,o,i,c,l,u,s,p,f,b,m,h,j,g,O,y,x=null===(a=t.payload)||void 0===a||null===(r=a.app)||void 0===r?void 0:r.logo;if(null!==x&&void 0!==x&&x.favicon||null!==(o=t.payload)&&void 0!==o&&null!==(i=o.unit)&&void 0!==i&&null!==(c=i.unit_app_attributes)&&void 0!==c&&c.favicon)document.getElementById("favicon").href=null!==(j=null===(g=t.payload)||void 0===g||null===(O=g.unit)||void 0===O||null===(y=O.unit_app_attributes)||void 0===y?void 0:y.favicon)&&void 0!==j?j:x.favicon;var w,U,_,D,C,T,L,R=null!==(l=null===(u=t.payload)||void 0===u||null===(s=u.unit)||void 0===s||null===(p=s.unit_app_attributes)||void 0===p||null===(f=p.layout)||void 0===f?void 0:f.primaryColor)&&void 0!==l?l:null===(b=t.payload)||void 0===b||null===(m=b.app)||void 0===m||null===(h=m.setting)||void 0===h?void 0:h.primaryColor;if(R){var M=document.querySelector(":root").style;M.setProperty("--bs-primary-rgb","".concat(R)),M.setProperty("--primary-color","".concat(R)),setTimeout((function(){document.querySelectorAll(".nav-link").forEach((function(t){t.style.color="".concat(R)}))}),80)}if("/error"!==window.location.pathname)if(null!==Object(d.n)())v.a.dispatch(Object(k.getAppMenu)({})).then((function(t){var e;"rejected"!==(null===t||void 0===t||null===(e=t.meta)||void 0===e?void 0:e.requestStatus)?(v.a.dispatch(Object(I.getUnits)({})),setTimeout((function(){v.a.dispatch(Object(S.e)({unread_count:1})).then((function(t){if(null!==t&&void 0!==t&&t.payload){var e,n,a=null!==(e=null===t||void 0===t||null===(n=t.payload[0])||void 0===n?void 0:n.count_unread)&&void 0!==e?e:0;if(a){var r=a>0&&a<=20?"(".concat(a,")"):"(20+)";document.title="".concat(r," ").concat(document.title.replaceAll(r,""))}}}))}),2e3)):(localStorage.setItem("lastUrl",window.location.href),n("/error"))}));else if("/login"===window.location.pathname&&-1===(null===(w=window.location.pathname)||void 0===w?void 0:w.indexOf("/public"))||"/reset-password"===window.location.pathname||"/forgot-password"===window.location.pathname||"/register"===window.location.pathname)"/reset-password"===window.location.pathname?n(window.location.pathname+window.location.search):"/forgot-password"===window.location.pathname?n("/forgot-password"):"/register"===window.location.pathname&&(null!==(U=t.payload)&&void 0!==U&&null!==(_=U.app)&&void 0!==_&&null!==(D=_.setting)&&void 0!==D&&D.enable_registration||null!==(C=t.payload)&&void 0!==C&&null!==(T=C.unit)&&void 0!==T&&null!==(L=T.unit_app_attributes)&&void 0!==L&&L.enable_registration)?n("/register"):n("/login");else n("/login")}})):(console.error("Offline"),A.a.fire({icon:"error",title:"Youre not connected to internet",text:"Please check your connection to the internet.",confirmButtonText:"Refresh",customClass:{confirmButton:"btn btn-primary"}}).then((function(t){t.isConfirmed&&location.reload()})))),function(){e.current=!0}}),[]),Object(m.jsx)(c.Suspense,{fallback:Object(m.jsx)(b.a,{}),children:Object(m.jsx)(x,{})})}},403:function(t,e,n){"use strict";n.r(e),n.d(e,"setUnitSelectedDropdown",(function(){return d})),n.d(e,"getUnits",(function(){return p})),n.d(e,"getUnit",(function(){return f})),n.d(e,"addUnit",(function(){return b})),n.d(e,"deleteUnit",(function(){return v})),n.d(e,"MyUnitsSlice",(function(){return m}));var a=n(5),r=n(4),o=n(3),i=n.n(o),c=n(6),l=n(15),u=n(31),s={value:"",label:"Select Unit"},d=Object(c.b)("Units/setUnitSelectedDropdown",(function(t){return t})),p=Object(c.b)("Units/getUnits",function(){var t=Object(r.a)(i.a.mark((function t(e,n){var a,r,o,c,s,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.rejectWithValue,e.flat_mode=!0,null===Object(u.n)()){t.next=38;break}return t.next=5,JSON.parse(localStorage.getItem("userData")).member_of;case 5:if(t.t1=r=t.sent,t.t0=null!==t.t1,!t.t0){t.next=9;break}t.t0=void 0!==r;case 9:if(!t.t0){t.next=13;break}t.t2=r,t.next=14;break;case 13:t.t2=[];case 14:if(!((o=t.t2).length>0)){t.next=28;break}if(c=!1,o.some((function(t){return t.children_count>0}))&&(c=!0),!c){t.next=25;break}return t.next=21,l.a.ssoAxiosInterceptor.get("/api/unit",{params:e});case 21:return s=t.sent,t.abrupt("return",{params:e,data:s.data.data,total:s.data.total});case 25:return t.abrupt("return",{data:o});case 26:t.next=38;break;case 28:return t.prev=28,t.next=31,l.a.ssoAxiosInterceptor.get("/api/unit",{params:e});case 31:return d=t.sent,t.abrupt("return",{params:e,data:d.data.data,total:d.data.total});case 35:return t.prev=35,t.t3=t.catch(28),t.abrupt("return",a(t.t3.response.data));case 38:case"end":return t.stop()}}),t,null,[[28,35]])})));return function(e,n){return t.apply(this,arguments)}}()),f=Object(c.b)("Units/getUnit",function(){var t=Object(r.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.get("/api/unit/".concat(e));case 2:return n=t.sent,t.abrupt("return",n.data.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),b=Object(c.b)("Units/addUnit",function(){var t=Object(r.a)(i.a.mark((function t(e,n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.dispatch,r=n.getState,t.next=3,axios.post("/api/unit",e);case 3:return t.next=5,a(p(r().units.params));case 5:return t.next=7,a(getAllUnit());case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),v=Object(c.b)("Units/deleteUnit",function(){var t=Object(r.a)(i.a.mark((function t(e,n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.dispatch,r=n.getState,t.next=3,axios.delete("/apps/unit",{id:e});case 3:return t.next=5,a(p(r().units.params));case 5:return t.next=7,a(getAllUnit());case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),m=Object(c.c)({name:"Units",initialState:{crudTitle:"Unit",statusSummary:0,isLoadingSummary:!1,errorSummary:0,dataSummary:[],status:0,isLoading:!1,error:0,data:[],total:1,dataDropdown:[],selectedUnit:{},selectedUnitMulti:[]},reducers:{setUnitSelected:function(t,e){return console.log("setUnitSelected"),Object(a.a)(Object(a.a)({},t),{},{selectedUnit:e.payload})},resetAll:function(t){t.data=[],t.dataDropdown=[],t.total=1,t.selectedUnit=null,t.selectedUnitMulti=null}},extraReducers:function(t){t.addCase(d.fulfilled,(function(t,e){return console.log("setUnitSelectedDropdown"),Object(a.a)(Object(a.a)({},t),{},{selectedUnit:e.payload})})).addCase(p.pending,(function(t){t.status="loading",t.isLoading=!0})).addCase(p.fulfilled,(function(t,e){var n,a;(t.status="succeeded",t.isLoading=!1,null!==(n=e.payload)&&void 0!==n&&n.data)&&(t.data=e.payload.data,t.dataDropdown=e.payload.data.map((function(t){return{value:t.id,label:t.name}})),t.dataDropdown.unshift(s),null!==(a=e.payload)&&void 0!==a&&a.total&&(t.total=e.payload.total),t.selectedUnit=t.dataDropdown[0])})).addCase(p.rejected,(function(t,e){t.status="failed",t.isLoading=!1,t.error=e.error.message})).addCase(f.fulfilled,(function(t,e){t.selectedUnit=e.payload}))}});e.default=m.reducer}}]);
//# sourceMappingURL=197.57f43fa1.chunk.js.map